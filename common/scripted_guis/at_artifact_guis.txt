at_artifacts_window_init_gui = {
	scope = character
	saved_scopes = { flavor }

	is_shown = {
		NOT = { has_game_rule = at_artifact_trading_disabled }
	}

	is_valid = {
		trigger_if = {
			limit = { scope:flavor = flag:sell }
			has_any_artifact = yes
		}
	}

	effect = {
		clear_global_variable_list = at_artifacts_window_artifact_sort_options
		add_to_global_variable_list = { name = at_artifacts_window_artifact_sort_options target = flag:_rarity }
		add_to_global_variable_list = { name = at_artifacts_window_artifact_sort_options target = flag:_durability }
		add_to_global_variable_list = { name = at_artifacts_window_artifact_sort_options target = flag:_type }
		add_to_global_variable_list = { name = at_artifacts_window_artifact_sort_options target = flag:_price }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_artifact_sort_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_artifact_sort_option
				value = flag:_rarity
			}
		}

		clear_global_variable_list = at_artifacts_window_rarity_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_rarity_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_rarity_filter_options target = flag:_common }
		add_to_global_variable_list = { name = at_artifacts_window_rarity_filter_options target = flag:_masterwork }
		add_to_global_variable_list = { name = at_artifacts_window_rarity_filter_options target = flag:_famed }
		add_to_global_variable_list = { name = at_artifacts_window_rarity_filter_options target = flag:_illustrious }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_rarity_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_rarity_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_slot_type_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_all_inventory }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_all_court }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_helmet }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_regalia }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_armor }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_primary_armament }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_miscellaneous }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_sculpture }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_pedestal }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_wall_big }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_wall_small }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_throne }
		add_to_global_variable_list = { name = at_artifacts_window_slot_type_filter_options target = flag:_book }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_slot_type_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_slot_type_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_unique_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_unique_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_unique_filter_options target = flag:_unique }
		add_to_global_variable_list = { name = at_artifacts_window_unique_filter_options target = flag:_not_unique }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_unique_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_unique_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_equipped_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_equipped_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_equipped_filter_options target = flag:_equipped }
		add_to_global_variable_list = { name = at_artifacts_window_equipped_filter_options target = flag:_not_equipped }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_equipped_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_equipped_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_owned_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_owned_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_owned_filter_options target = flag:_owned_by_you }
		add_to_global_variable_list = { name = at_artifacts_window_owned_filter_options target = flag:_not_owned_by_you }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_owned_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_owned_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_claimed_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_claimed_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_claimed_filter_options target = flag:_claimed_by_you }
		add_to_global_variable_list = { name = at_artifacts_window_claimed_filter_options target = flag:_claimed_by_others }
		add_to_global_variable_list = { name = at_artifacts_window_claimed_filter_options target = flag:_not_claimed }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_claimed_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_claimed_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_equippable_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_equippable_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_equippable_filter_options target = flag:_equippable_by_you }
		add_to_global_variable_list = { name = at_artifacts_window_equippable_filter_options target = flag:_not_equippable_by_you }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_equippable_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_equippable_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_unwanted_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_unwanted_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_unwanted_filter_options target = flag:_unwanted }
		add_to_global_variable_list = { name = at_artifacts_window_unwanted_filter_options target = flag:_not_unwanted }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_unwanted_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_unwanted_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_owner_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_owner_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_owner_filter_options target = flag:_ruler_with_rc }
		add_to_global_variable_list = { name = at_artifacts_window_owner_filter_options target = flag:_ruler_without_rc }
		add_to_global_variable_list = { name = at_artifacts_window_owner_filter_options target = flag:_not_ruler }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_owner_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_owner_filter_option
				value = flag:_all
			}
		}

		clear_global_variable_list = at_artifacts_window_owner_valid_buyer_or_seller_filter_options
		add_to_global_variable_list = { name = at_artifacts_window_owner_valid_buyer_or_seller_filter_options target = flag:_all }
		add_to_global_variable_list = { name = at_artifacts_window_owner_valid_buyer_or_seller_filter_options target = flag:_valid_buyer_or_seller }
		add_to_global_variable_list = { name = at_artifacts_window_owner_valid_buyer_or_seller_filter_options target = flag:_not_valid_buyer_or_seller }

		if = {
			limit = {
				NOT = { exists = global_var:at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option }
			}
			set_global_variable = {
				name = at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option
				value = flag:_all
			}
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes

		if = {
			limit = { has_global_variable = at_artifacts_window_selected_artifact }
			remove_global_variable = at_artifacts_window_selected_artifact
		}
	}
}

at_artifacts_window_send_gui = {
	scope = character
	saved_scopes = { flavor artifact }

	effect = {
		clear_global_variable_list = at_artifacts_window_all_artifacts
		clear_global_variable_list = at_artifacts_window_artifacts

		set_global_variable = {
			name = at_artifacts_window_selected_artifact
			value = scope:artifact
			days = 1
		}

		if = {
			limit = { scope:flavor = flag:sell }
			open_interaction_window = {
				interaction = at_sell_artifacts_interaction
				actor = ROOT
				recipient = ROOT
			}
		}
		else_if = {
			limit = { scope:flavor = flag:buy }
			open_interaction_window = {
				interaction = at_buy_artifact_interaction
				actor = ROOT
				recipient = global_var:at_artifacts_window_selected_artifact.artifact_owner
			}
			remove_global_variable = at_artifacts_window_selected_artifact
		}
	}
}

at_artifacts_window_close_gui = {
	scope = character

	effect = {
		clear_global_variable_list = at_artifacts_window_all_artifacts
		clear_global_variable_list = at_artifacts_window_artifacts

		if = {
			limit = { has_global_variable = at_artifacts_window_selected_artifact }
			remove_global_variable = at_artifacts_window_selected_artifact
		}
	}
}

at_artifacts_window_select_artifact_sort_option_gui = {
	scope = character
	saved_scopes = { sort_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_artifact_sort_option
			value = scope:sort_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_toggle_artifact_sort_order_gui = {
	scope = character

	effect = {
		if = {
			limit = { has_global_variable = at_artifacts_window_is_artifact_sort_order_ascending }
			remove_global_variable = at_artifacts_window_is_artifact_sort_order_ascending
		}
		else = {
			set_global_variable = at_artifacts_window_is_artifact_sort_order_ascending
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_has_personal_claim_gui = {
	scope = character
	saved_scopes = { artifact }

	is_shown = {
		any_personal_claimed_artifact = {
			this = scope:artifact
		}
	}
}

at_artifacts_window_has_house_claim_gui = {
	scope = character
	saved_scopes = { artifact }

	is_shown = {
		exists = house
		house = {
			any_house_claimed_artifact = {
				this = scope:artifact
			}
		}
	}
}

at_artifacts_window_has_non_default_filter_options_gui = {
	scope = character

	is_shown = {
		trigger_if = {
			limit = {
				has_global_variable = at_artifacts_window_selected_rarity_filter_option
				has_global_variable = at_artifacts_window_selected_slot_type_filter_option
				has_global_variable = at_artifacts_window_selected_unique_filter_option
				has_global_variable = at_artifacts_window_selected_equipped_filter_option
				has_global_variable = at_artifacts_window_selected_owned_filter_option
				has_global_variable = at_artifacts_window_selected_claimed_filter_option
				has_global_variable = at_artifacts_window_selected_equippable_filter_option
				has_global_variable = at_artifacts_window_selected_unwanted_filter_option
				has_global_variable = at_artifacts_window_selected_owner_filter_option
				has_global_variable = at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option
			}
			NAND = {
				global_var:at_artifacts_window_selected_rarity_filter_option = flag:_all
				global_var:at_artifacts_window_selected_slot_type_filter_option = flag:_all
				global_var:at_artifacts_window_selected_unique_filter_option = flag:_all
				global_var:at_artifacts_window_selected_equipped_filter_option = flag:_all
				global_var:at_artifacts_window_selected_owned_filter_option = flag:_all
				global_var:at_artifacts_window_selected_claimed_filter_option = flag:_all
				global_var:at_artifacts_window_selected_equippable_filter_option = flag:_all
				global_var:at_artifacts_window_selected_unwanted_filter_option = flag:_all
				global_var:at_artifacts_window_selected_owner_filter_option = flag:_all
				global_var:at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option = flag:_all
			}
		}
		trigger_else = {
			always = no
		}
	}
}

at_artifacts_window_select_rarity_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_rarity_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_slot_type_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_slot_type_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_unique_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_unique_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_equipped_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_equipped_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_owned_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_owned_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_claimed_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_claimed_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_equippable_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_equippable_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_unwanted_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_unwanted_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_owner_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_owner_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_select_owner_valid_buyer_or_seller_filter_option_gui = {
	scope = character
	saved_scopes = { filter_option }

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option
			value = scope:filter_option
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}

at_artifacts_window_reset_filter_options_gui = {
	scope = character

	effect = {
		set_global_variable = {
			name = at_artifacts_window_selected_rarity_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_slot_type_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_unique_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_equipped_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_owned_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_claimed_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_equippable_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_unwanted_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_owner_filter_option
			value = flag:_all
		}
		set_global_variable = {
			name = at_artifacts_window_selected_owner_valid_buyer_or_seller_filter_option
			value = flag:_all
		}

		at_artifacts_window_get_all_artifacts_effect = yes
		at_artifacts_window_get_artifacts_effect = yes
	}
}
