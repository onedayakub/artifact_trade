at_artifacts_window_get_artifacts_effect = {
	if = {
		limit = { scope:flavor = flag:sell }
		every_character_artifact = {
			limit = { is_equipped = no }
			add_to_temporary_list = $LIST$
		}
	}
	else_if = {
		limit = { scope:flavor = flag:buy }
		at_get_valid_buyers_or_sellers_effect = { LIST = valid_buyers }
		every_in_list = {
			list = valid_buyers
			limit = {
				at_candidate_to_sell_artifact_to_trigger = { PARTY = ROOT }
			}
			every_character_artifact = {
				limit = { is_equipped = no }
				add_to_temporary_list = $LIST$
			}
		}
	}
	else = {
		every_artifact = {
			add_to_temporary_list = $LIST$
		}
	}
}

at_artifacts_window_sort_artifacts_effect = {
	clear_variable_list = at_artifacts_window_artifacts
	ordered_in_list = {
		list = $LIST$
		order_by = {
			if = {
				limit = { ROOT.var:at_artifacts_window_selected_artifact_sort_option = flag:_rarity }
				value = artifact_rarity
			}
			else_if = {
				limit = { ROOT.var:at_artifacts_window_selected_artifact_sort_option = flag:_durability }
				value = artifact_durability
			}
			else_if = {
				limit = { ROOT.var:at_artifacts_window_selected_artifact_sort_option = flag:_type }
				value = at_artifact_type_value
			}
			if = {
				limit = {
					ROOT = { has_variable = at_artifacts_window_is_artifact_sort_order_ascending }
				}
				multiply = -1
			}
		}
		max = 1000
		check_range_bounds = no

		ROOT = {
			add_to_variable_list = {
				name = at_artifacts_window_artifacts
				target = PREV
			}
		}
	}
}